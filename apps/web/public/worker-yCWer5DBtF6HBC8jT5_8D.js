(()=>{const o=self;o.addEventListener("install",t=>{console.log("[Worker] Instalando Service Worker customizado..."),t.waitUntil(o.skipWaiting())}),o.addEventListener("activate",t=>{console.log("[Worker] Ativando Service Worker customizado..."),t.waitUntil(o.clients.claim())}),o.addEventListener("sync",t=>{console.log("[Worker] Sync event disparado:",t.tag),"sync-critical-data"===t.tag&&t.waitUntil(async function(){try{console.log("[Worker] Executando sincronização crítica em background...");(await o.clients.matchAll()).forEach(o=>{o.postMessage({type:"SYNC_STARTED",timestamp:Date.now()})}),console.log("[Worker] Sincronização em background concluída.")}catch(o){throw console.error("[Worker] Erro no sync:",o),o}}())}),o.addEventListener("push",t=>{if(t.data)try{const n=t.data.json(),e=n.title||"Nova Notificação",i={body:n.body||"",icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",data:n.data||{},actions:n.actions||[],tag:n.tag||"versix-norma-notification"};t.waitUntil(o.registration.showNotification(e,i))}catch(o){console.error("[Worker] Erro ao processar push:",o)}}),o.addEventListener("notificationclick",t=>{t.notification.close(),t.waitUntil(o.clients.matchAll({type:"window",includeUncontrolled:!0}).then(t=>{if(t.length>0){let o=t[0];for(let n=0;n<t.length;n++)t[n].focused&&(o=t[n]);return o.focus()}return o.clients.openWindow("/")}))})})();